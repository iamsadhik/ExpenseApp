<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense App</title>
    <link rel="stylesheet" href="file.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" />
    <script src="https://kit.fontawesome.com/7f2b20e485.js"></script>
</head>

<body>
    <nav class="navbar navbar-dark bg-dark">
        <span class="navbar-brand mb-0 h1">Xpers
            <h2 id="expenseSum"></h2>
        </span>
    </nav>
    <div class="container">
        <div class="jumbotron mt-4">
            <div class="input-group mb-3">
                <input type="text" class="form-control" id="inpt" placeholder="Amount spent" aria-label="Amount spent"
                    aria-describedby="spent in rupee" />
                <div class="input-group-append">
                    <span class="input-group-text" id="spent in rupee">â‚¹</span>
                </div>
            </div>
            <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="spent at">@</span>
                </div>
                <input type="text" id="inptDesc" class="form-control" placeholder="spent On" aria-label="spent On"
                    aria-describedby="spent at" />
                <div class="input-group-append">
                    <button class="btn
            btn-outline-primary" type="button" id="bttn">Add</button>

                </div>
            </div>
        </div>
    </div>
    </div>

    <div>
        <ul class="list-group" id="table">
        </ul>
    </div>



    <script>
        let totalExpense = 0;
        const allExpense = [];

        const addExpenseTotal = () => {
            const expenseObj = {}

            const expense = inputElement.value;
            const expensePurpose = displayItem.value;
            // console.log({expense,expensePurpose});

            const intergerElement = parseInt(expense, 10);
            totalExpense = totalExpense + intergerElement;
            const someText = `${totalExpense}`
            displaySum.innerHTML = someText;


            expenseObj.desc = expensePurpose;
            expenseObj.amount = expense;
            expenseObj.moment = new Date();
            allExpense.push(expenseObj);


            const allExpenses = allExpense.map(items => viewListOnClick(items));

            const joinedallExpensesHtml = allExpenses.join("");
            displayTable.innerHTML = joinedallExpensesHtml;
            console.log(joinedallExpensesHtml)


        }
        const btnElement = document.querySelector('#bttn');
        const inputElement = document.querySelector('#inpt');
        const displaySum = document.querySelector('#expenseSum');
        const displayItem = document.querySelector('#inptDesc');
        const displayTable = document.querySelector('#table');
        btnElement.addEventListener("click", addExpenseTotal);

        const deleteItem = (dateValue) => {
            console.log(dateValue)
            const newarr = [];
            for (let i = 0; i < allExpense.length; i++) {
                if (allExpense[i].moment.valueOf() !== dateValue) {
                    newarr.push(allExpense[i])
                    console.log(allExpense)
                }
          renderList(newarr)

            }
        }
     
        function renderList(NewArray){
            const allExpenses = NewArray.map(items => viewListOnClick(items));
            console.log(allExpenses);

            const joinedallExpensesHtml = allExpenses.join("");
            displayTable.innerHTML = joinedallExpensesHtml;
            console.log(joinedallExpensesHtml)
        }

        function viewListOnClick({
            desc,
            amount,
            moment
        }) {
            return (
                `<li class="list-group-item d-flex justify-content-between">
							<div class="d-flex flex-column">
								${desc}
								<small class="text-muted">${currentTime(moment)}</small>
							</div>
							<div>
								<span class="px-5">
									${amount}
								</span>
								<button type="button" class="btn btn-outline-danger btn-sm" 
                                onclick="deleteItem(${moment.valueOf()})">
									<i class="fas fa-trash-alt"></i>
								</button>
							</div>
						</li>
                        `)

        }
        const currentTime = (momento) => {
            return momento.toLocaleDateString('en-US', {
                month: "long",
                day: "numeric",
                year: "numeric",
            })
        }
    </script>



</body>

</html>